{"ast":null,"code":"import _slicedToArray from\"/Library/WebServer/Documents/MachineLearning/trading/PKT-CASH/LUX/ODApp/packages/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"/Library/WebServer/Documents/MachineLearning/trading/PKT-CASH/LUX/ODApp/packages/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Library/WebServer/Documents/MachineLearning/trading/PKT-CASH/LUX/ODApp/packages/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useState}from\"react\";import{useQuery}from\"@apollo/react-hooks\";import{ethers}from\"ethers\";import detectEthereumProvider from'@metamask/detect-provider';import MetaMaskOnboarding from'@metamask/onboarding';import{Button,Footer,Text,Box,Grommet,ResponsiveContext}from\"grommet\";import{BrowserRouter as Router,Route,Switch}from\"react-router-dom\";import Teleport from\"./components/Teleport\";import Collapsible from\"./components/Collapsible\";//import useWeb3Modal from \"./hooks/useWeb3Modal\";\nimport GET_TRANSFERS from\"./graphql/subgraph\";import logoFooter from\"./img/odapp-logo-footer.svg\";import{StyledButton,ButtonForm,ButtonFooter,ImageFooter,customBreakpoints}from\"./components/\";import WalletConnectProvider from\"@walletconnect/web3-provider\";import{Connect}from'grommet-icons';var clr='#FBA300';var web3Provider,provider;var forwarderOrigin='http://localhost:3000';var onboardButton=document.getElementById('cnct');var connected=false;var installed=false;var accounts=null;function isMetaMaskConnected(){return _isMetaMaskConnected.apply(this,arguments);}function _isMetaMaskConnected(){_isMetaMaskConnected=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){var _window2,ethereum;return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_window2=window,ethereum=_window2.ethereum;_context4.next=3;return ethereum.request({method:'eth_accounts'});case 3:accounts=_context4.sent;console.log('accounts',accounts[0]);return _context4.abrupt(\"return\",accounts&&accounts.length>0);case 6:case\"end\":return _context4.stop();}}},_callee4);}));return _isMetaMaskConnected.apply(this,arguments);}function isMetaMaskInstalled(){return Boolean(window.ethereum&&window.ethereum.isMetaMask);}function initialise(){return _initialise.apply(this,arguments);}function _initialise(){_initialise=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:connected=false;installed=false;_context5.next=4;return isMetaMaskConnected();case 4:connected=_context5.sent;installed=isMetaMaskInstalled();case 6:case\"end\":return _context5.stop();}}},_callee5);}));return _initialise.apply(this,arguments);}initialise();window.ethereum.on('accountsChanged',/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:initialise();console.log('accounts changed here');window.location.reload();case 3:case\"end\":return _context.stop();}}},_callee);})));var onClickConnect=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _window,ethereum;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_window=window,ethereum=_window.ethereum;_context2.prev=1;// Will open the MetaMask UI\nconsole.log(\"Try to connect here\");_context2.next=5;return ethereum.request({method:'eth_requestAccounts'});case 5:_context2.next=10;break;case 7:_context2.prev=7;_context2.t0=_context2[\"catch\"](1);console.error(_context2.t0);case 10:case\"end\":return _context2.stop();}}},_callee2,null,[[1,7]]);}));return function onClickConnect(){return _ref2.apply(this,arguments);};}();function WalletButton(){//{ provider, loadWeb3Modal, logoutOfWeb3Modal, clr}\nvar onboarding=new MetaMaskOnboarding({forwarderOrigin:forwarderOrigin});var _useState=useState(\"\"),_useState2=_slicedToArray(_useState,2),label=_useState2[0],setLabel=_useState2[1];var connectedStr=accounts&&accounts.length>0?accounts[0].toString().slice(0,6)+'...':\"Disconnect Wallet\";console.log(\"clicked\");return/*#__PURE__*/React.createElement(StyledButton,{primary:true,size:\"large\",pad:\"medium\",color:\"#F0B90C\",label:!connected?\"Connect Wallet\":connectedStr,onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(){return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:onClickConnect();if(!(typeof window.ethereum==='undefined')){_context3.next=4;break;}onboarding.startOnboarding();return _context3.abrupt(\"return\");case 4:case\"end\":return _context3.stop();}}},_callee3);}))});}function App(){var _useQuery=useQuery(GET_TRANSFERS),loading=_useQuery.loading,error=_useQuery.error,data=_useQuery.data;//const [provider, loadWeb3Modal, logoutOfWeb3Modal] = useWeb3Modal();\n/*const items = [\n    { label: 'Teleport', href: '/' },\n    { label: 'Connect Wallet', onClick: () => {onClickConnect()}}\n  ];*/React.useEffect(function(){if(!loading&&!error&&data&&data.transfers){console.log({transfers:data.transfers});}},[loading,error,data]);//connectMetamask();\nreturn/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Collapsible,{btn:WalletButton()}),/*#__PURE__*/React.createElement(Router,null,/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/\"},/*#__PURE__*/React.createElement(Teleport,{btn:WalletButton()})))));}export default App;","map":{"version":3,"names":["React","useState","useQuery","ethers","detectEthereumProvider","MetaMaskOnboarding","Button","Footer","Text","Box","Grommet","ResponsiveContext","BrowserRouter","Router","Route","Switch","Teleport","Collapsible","GET_TRANSFERS","StyledButton","ButtonForm","ButtonFooter","ImageFooter","customBreakpoints","WalletConnectProvider","Connect","clr","web3Provider","provider","forwarderOrigin","onboardButton","document","getElementById","connected","installed","accounts","isMetaMaskConnected","window","ethereum","request","method","console","log","length","isMetaMaskInstalled","Boolean","isMetaMask","initialise","on","location","reload","onClickConnect","error","WalletButton","onboarding","label","setLabel","connectedStr","toString","slice","startOnboarding","App","loading","data","useEffect","transfers"],"sources":["/Library/WebServer/Documents/MachineLearning/trading/PKT-CASH/LUX/ODApp/packages/react-app/src/App.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useQuery } from \"@apollo/react-hooks\";\nimport { ethers } from \"ethers\";\nimport detectEthereumProvider from '@metamask/detect-provider'\nimport MetaMaskOnboarding from '@metamask/onboarding'\nimport { Button, Footer, Text, Box, Grommet, ResponsiveContext } from \"grommet\";\nimport { BrowserRouter as Router, Route, Switch } from \"react-router-dom\";\nimport Teleport from \"./components/Teleport\";\nimport Collapsible from \"./components/Collapsible\";\n//import useWeb3Modal from \"./hooks/useWeb3Modal\";\nimport GET_TRANSFERS from \"./graphql/subgraph\";\nimport logoFooter from \"./img/odapp-logo-footer.svg\";\nimport { StyledButton, ButtonForm, ButtonFooter, ImageFooter, customBreakpoints } from \"./components/\";\nimport WalletConnectProvider from \"@walletconnect/web3-provider\";\n\nimport {\n  Connect\n} from 'grommet-icons';\n\nvar clr = '#FBA300';\n\n\nvar web3Provider, provider;\nconst forwarderOrigin = 'http://localhost:3000';\nconst onboardButton = document.getElementById('cnct');\n\nlet connected = false;\nlet installed = false;\nlet accounts = null;\n\nasync function isMetaMaskConnected() {\n    const {ethereum} = window;\n    accounts = await ethereum.request({method: 'eth_accounts'});\n    console.log('accounts', accounts[0]);\n    return accounts && accounts.length > 0;\n}\n\nfunction isMetaMaskInstalled() {\n    return Boolean(window.ethereum && window.ethereum.isMetaMask);\n}\n\nasync function initialise() {\n    connected = false;\n    installed = false;\n    connected = await isMetaMaskConnected();\n    installed = isMetaMaskInstalled();\n}\n\ninitialise();\n\nwindow.ethereum.on('accountsChanged', async () => {\n    initialise();\n    console.log('accounts changed here');\n    window.location.reload();\n});\n\n\nconst onClickConnect = async () => {\n  const { ethereum } = window;\n   try {\n     // Will open the MetaMask UI\n     console.log(\"Try to connect here\");\n     await ethereum.request({ method: 'eth_requestAccounts' });\n     //window.location.reload();\n   } catch (error) {\n     console.error(error);\n   }\n };\n\n\n\nfunction WalletButton() {//{ provider, loadWeb3Modal, logoutOfWeb3Modal, clr}\n\n  const onboarding = new MetaMaskOnboarding({ forwarderOrigin });\n  const [label, setLabel] = useState(\"\");\n\n  var connectedStr = (accounts && accounts.length > 0) ? ((accounts[0].toString()).slice(0,6))+'...' :  \"Disconnect Wallet\";\n\n  console.log(\"clicked\");\n\n  return (\n\n    <StyledButton primary size='large' pad=\"medium\" color='#F0B90C' label={!connected ? \"Connect Wallet\" : connectedStr} onClick={async () => {\n      onClickConnect();\n\n      if (typeof window.ethereum === 'undefined') {\n        onboarding.startOnboarding();\n        return;\n      }\n    }}/>\n\n  );\n}\n\n\n\n\n\nfunction App() {\n\n  const { loading, error, data } = useQuery(GET_TRANSFERS);\n  //const [provider, loadWeb3Modal, logoutOfWeb3Modal] = useWeb3Modal();\n  /*const items = [\n    { label: 'Teleport', href: '/' },\n    { label: 'Connect Wallet', onClick: () => {onClickConnect()}}\n  ];*/\n\n  React.useEffect(() => {\n    if (!loading && !error && data && data.transfers) {\n      console.log({ transfers: data.transfers });\n    }\n  }, [loading, error, data]);\n\n  //connectMetamask();\n\n  return (\n    <div>\n    <Collapsible btn={ WalletButton() }/>\n        <Router>\n          <Switch>\n\n\n            <Route exact path=\"/\">\n              <Teleport btn={ WalletButton() }/>\n            </Route>\n\n          </Switch>\n        </Router>\n\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}