{"ast":null,"code":"import _slicedToArray from\"/Library/WebServer/Documents/MachineLearning/trading/PKT-CASH/LUX/LUXDApp/LUXBridgeDApp/packages/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import _regeneratorRuntime from\"/Library/WebServer/Documents/MachineLearning/trading/PKT-CASH/LUX/LUXDApp/LUXBridgeDApp/packages/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/Library/WebServer/Documents/MachineLearning/trading/PKT-CASH/LUX/LUXDApp/LUXBridgeDApp/packages/react-app/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import React,{useState}from\"react\";import{useQuery}from\"@apollo/react-hooks\";import{ethers}from\"ethers\";import detectEthereumProvider from'@metamask/detect-provider';import MetaMaskOnboarding from'@metamask/onboarding';import{Button,Footer,Text,Box,Grommet,ResponsiveContext}from\"grommet\";import{BrowserRouter as Router,Route,Switch}from\"react-router-dom\";import Teleport from\"./components/Teleport\";import Collapsible from\"./components/Collapsible\";//import useWeb3Modal from \"./hooks/useWeb3Modal\";\nimport Cookies from'universal-cookie';import GET_TRANSFERS from\"./graphql/subgraph\";import logoFooter from\"./img/odapp-logo-footer.svg\";import{StyledButton,ButtonForm,ButtonFooter,ImageFooter,customBreakpoints}from\"./components/\";import WalletConnectProvider from\"@walletconnect/web3-provider\";import{Connect}from'grommet-icons';var clr='#FBA300';var cookies=new Cookies();var web3Provider,provider;var forwarderOrigin='http://lux.wpkt.cash';var connected=false;var installed=false;var accounts=null;var connectedStr=\"Wallet Connect\";var currentAccount=null;function isMetaMaskConnected(){return _isMetaMaskConnected.apply(this,arguments);}function _isMetaMaskConnected(){_isMetaMaskConnected=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee5(){var _window3,ethereum;return _regeneratorRuntime.wrap(function _callee5$(_context5){while(1){switch(_context5.prev=_context5.next){case 0:_window3=window,ethereum=_window3.ethereum;_context5.next=3;return ethereum.request({method:'eth_accounts'});case 3:accounts=_context5.sent;console.log('In Metamask connection:',accounts&&accounts.length>0);return _context5.abrupt(\"return\",Boolean(accounts&&accounts.length>0));case 6:case\"end\":return _context5.stop();}}},_callee5);}));return _isMetaMaskConnected.apply(this,arguments);}function isMetaMaskInstalled(){console.log('In isMetaMaskInstalled');return Boolean(window.ethereum&&window.ethereum.isMetaMask);}function initialize(){return _initialize.apply(this,arguments);}//initialize();\nfunction _initialize(){_initialize=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee6(){return _regeneratorRuntime.wrap(function _callee6$(_context6){while(1){switch(_context6.prev=_context6.next){case 0:connected=false;installed=false;_context6.next=4;return isMetaMaskConnected();case 4:connected=_context6.sent;installed=isMetaMaskInstalled();case 6:case\"end\":return _context6.stop();}}},_callee6);}));return _initialize.apply(this,arguments);}if(typeof window.ethereum!=='undefined'){window.ethereum.on('accountsChanged',/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(){return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:_context.next=2;return initialize();case 2:console.log('accounts changed here');if(connectedStr!=='Wallet Connect'){window.location.reload();}case 4:case\"end\":return _context.stop();}}},_callee);})));}var onClickConnect=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){var _window,ethereum;return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_window=window,ethereum=_window.ethereum;_context2.prev=1;// Will open the MetaMask UI\nconsole.log(\"Try to connect here\");_context2.next=5;return ethereum.request({method:'eth_requestAccounts'});case 5:currentAccount=_context2.sent;console.log('current account:',currentAccount,accounts[0]);_context2.next=12;break;case 9:_context2.prev=9;_context2.t0=_context2[\"catch\"](1);console.error(_context2.t0);case 12:case\"end\":return _context2.stop();}}},_callee2,null,[[1,9]]);}));return function onClickConnect(){return _ref2.apply(this,arguments);};}();var buttonSetup=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(label,setLabel){var _window2,ethereum;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:_window2=window,ethereum=_window2.ethereum;_context3.prev=1;_context3.next=4;return initialize();case 4:connectedStr=accounts&&accounts.length>0?accounts[0].toString().slice(0,6)+'...':\"Connect Wallet\";setLabel(connectedStr);_context3.next=11;break;case 8:_context3.prev=8;_context3.t0=_context3[\"catch\"](1);console.error(_context3.t0);case 11:case\"end\":return _context3.stop();}}},_callee3,null,[[1,8]]);}));return function buttonSetup(_x,_x2){return _ref3.apply(this,arguments);};}();function WalletButton(){var onboarding=new MetaMaskOnboarding({forwarderOrigin:forwarderOrigin});var _useState=useState(\"Connect Wallet\"),_useState2=_slicedToArray(_useState,2),label=_useState2[0],setLabel=_useState2[1];buttonSetup(label,setLabel);return/*#__PURE__*/React.createElement(StyledButton,{id:\"connectButton\",primary:true,size:\"large\",pad:\"medium\",color:\"#F0B90C\",label:label,onClick:/*#__PURE__*/_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee4(){return _regeneratorRuntime.wrap(function _callee4$(_context4){while(1){switch(_context4.prev=_context4.next){case 0:_context4.next=2;return onClickConnect();case 2:connectedStr=accounts&&accounts.length>0?accounts[0].toString().slice(0,6)+'...':\"Connect Wallet\";console.log('currentAccount:',currentAccount,'connectedStr:',connectedStr,'connected:',connected,'accounts:',accounts&&accounts.length>0);setLabel(connectedStr);if(!(typeof window.ethereum==='undefined')){_context4.next=8;break;}onboarding.startOnboarding();return _context4.abrupt(\"return\");case 8:case\"end\":return _context4.stop();}}},_callee4);}))});}function App(){var _useQuery=useQuery(GET_TRANSFERS),loading=_useQuery.loading,error=_useQuery.error,data=_useQuery.data;var items=[{label:'Teleport',href:'/'}];React.useEffect(function(){if(!loading&&!error&&data&&data.transfers){console.log({transfers:data.transfers});}},[loading,error,data]);return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(Collapsible,{btn:WalletButton()}),/*#__PURE__*/React.createElement(Router,null,/*#__PURE__*/React.createElement(Switch,null,/*#__PURE__*/React.createElement(Route,{exact:true,path:\"/\"},/*#__PURE__*/React.createElement(Teleport,{btn:WalletButton()})))));}export default App;","map":{"version":3,"names":["React","useState","useQuery","ethers","detectEthereumProvider","MetaMaskOnboarding","Button","Footer","Text","Box","Grommet","ResponsiveContext","BrowserRouter","Router","Route","Switch","Teleport","Collapsible","Cookies","GET_TRANSFERS","StyledButton","ButtonForm","ButtonFooter","ImageFooter","customBreakpoints","WalletConnectProvider","Connect","clr","cookies","web3Provider","provider","forwarderOrigin","connected","installed","accounts","connectedStr","currentAccount","isMetaMaskConnected","window","ethereum","request","method","console","log","length","Boolean","isMetaMaskInstalled","isMetaMask","initialize","on","location","reload","onClickConnect","error","buttonSetup","label","setLabel","toString","slice","WalletButton","onboarding","startOnboarding","App","loading","data","items","href","useEffect","transfers"],"sources":["/Library/WebServer/Documents/MachineLearning/trading/PKT-CASH/LUX/LUXDApp/LUXBridgeDApp/packages/react-app/src/App.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useQuery } from \"@apollo/react-hooks\";\nimport { ethers } from \"ethers\";\nimport detectEthereumProvider from '@metamask/detect-provider'\nimport MetaMaskOnboarding from '@metamask/onboarding'\nimport { Button, Footer, Text, Box, Grommet, ResponsiveContext } from \"grommet\";\nimport { BrowserRouter as Router, Route, Switch } from \"react-router-dom\";\nimport Teleport from \"./components/Teleport\";\nimport Collapsible from \"./components/Collapsible\";\n//import useWeb3Modal from \"./hooks/useWeb3Modal\";\nimport Cookies from 'universal-cookie';\nimport GET_TRANSFERS from \"./graphql/subgraph\";\nimport logoFooter from \"./img/odapp-logo-footer.svg\";\nimport { StyledButton, ButtonForm, ButtonFooter, ImageFooter, customBreakpoints } from \"./components/\";\nimport WalletConnectProvider from \"@walletconnect/web3-provider\";\nimport {\n  Connect\n} from 'grommet-icons';\n\nvar clr = '#FBA300';\n\nconst cookies = new Cookies();\n\nvar web3Provider, provider;\nconst forwarderOrigin = 'http://lux.wpkt.cash';\n\nlet connected = false;\nlet installed = false;\nlet accounts = null;\nlet connectedStr = \"Wallet Connect\";\nlet currentAccount = null;\n\nasync function isMetaMaskConnected() {\n    const {ethereum} = window;\n    accounts = await ethereum.request({method: 'eth_accounts'});\n    console.log('In Metamask connection:', (accounts && accounts.length > 0));\n    return Boolean(accounts && accounts.length > 0);\n}\n\nfunction isMetaMaskInstalled() {\n    console.log('In isMetaMaskInstalled');\n    return Boolean(window.ethereum && window.ethereum.isMetaMask);\n}\n\n\nasync function initialize() {\n    connected = false;\n    installed = false;\n    connected = await isMetaMaskConnected();\n    installed = isMetaMaskInstalled();\n}\n\n//initialize();\n\nif (typeof window.ethereum !== 'undefined') {\n  window.ethereum.on('accountsChanged', async () => {\n      await initialize();\n      console.log('accounts changed here');\n      if (connectedStr !== 'Wallet Connect'){\n        window.location.reload();\n      }\n\n  });\n}\n\n\nconst onClickConnect = async () => {\n  const { ethereum } = window;\n   try {\n     // Will open the MetaMask UI\n     console.log(\"Try to connect here\");\n     currentAccount = await ethereum.request({ method: 'eth_requestAccounts' });\n     console.log('current account:', currentAccount, accounts[0]);\n   } catch (error) {\n     console.error(error);\n   }\n };\n\n\n const buttonSetup = async (label, setLabel) => {\n   const { ethereum } = window;\n    try {\n      // Will open the MetaMask UI\n      await initialize();\n      connectedStr = (accounts && accounts.length > 0) ? ((accounts[0].toString()).slice(0,6))+'...' :  \"Connect Wallet\";\n      setLabel(connectedStr);\n\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n\nfunction WalletButton() {\n  const onboarding = new MetaMaskOnboarding({ forwarderOrigin });\n  const [label, setLabel] = useState(\"Connect Wallet\");\n  buttonSetup(label, setLabel);\n\n\n  return (\n    <StyledButton id=\"connectButton\" primary size='large' pad=\"medium\" color='#F0B90C' label={label} onClick={async () => {\n      await onClickConnect();\n      connectedStr = (accounts && accounts.length > 0) ? ((accounts[0].toString()).slice(0,6))+'...' :  \"Connect Wallet\";\n      console.log('currentAccount:',currentAccount, 'connectedStr:', connectedStr, 'connected:', connected, 'accounts:', (accounts && accounts.length > 0));\n      setLabel(connectedStr);\n\n      if (typeof window.ethereum === 'undefined') {\n        onboarding.startOnboarding();\n        return;\n      }\n    }}/>\n\n  );\n}\n\n\n\nfunction App() {\n\n  const { loading, error, data } = useQuery(GET_TRANSFERS);\n\n  const items = [\n    { label: 'Teleport', href: '/' },\n  ];\n\n  React.useEffect(() => {\n    if (!loading && !error && data && data.transfers) {\n      console.log({ transfers: data.transfers });\n    }\n  }, [loading, error, data]);\n\n\n\n  return (\n    <div>\n    <Collapsible btn={ WalletButton() }/>\n        <Router>\n          <Switch>\n            <Route exact path=\"/\">\n              <Teleport btn={ WalletButton() }/>\n            </Route>\n\n          </Switch>\n        </Router>\n\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}