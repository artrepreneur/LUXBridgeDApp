{"ast":null,"code":"var _jsxFileName = \"/Library/WebServer/Documents/MachineLearning/trading/PKT-CASH/LUX/LUXDApp/LUXBridgeDApp/packages/react-app/src/App.js\";\nimport React, { useState } from \"react\";\nimport { useQuery } from \"@apollo/react-hooks\";\nimport { ethers } from \"ethers\";\nimport detectEthereumProvider from '@metamask/detect-provider';\nimport MetaMaskOnboarding from '@metamask/onboarding';\nimport { Button, Footer, Text, Box, Grommet, ResponsiveContext } from \"grommet\";\nimport { BrowserRouter as Router, Route, Switch } from \"react-router-dom\";\nimport Teleport from \"./components/Teleport\";\nimport Collapsible from \"./components/Collapsible\"; //import useWeb3Modal from \"./hooks/useWeb3Modal\";\n\nimport Cookies from 'universal-cookie';\nimport GET_TRANSFERS from \"./graphql/subgraph\";\nimport logoFooter from \"./img/odapp-logo-footer.svg\";\nimport { StyledButton, ButtonForm, ButtonFooter, ImageFooter, customBreakpoints } from \"./components/\";\nimport WalletConnectProvider from \"@walletconnect/web3-provider\";\nimport { Connect } from 'grommet-icons';\nvar clr = '#FBA300';\nconst cookies = new Cookies();\nvar web3Provider, provider;\nconst forwarderOrigin = 'http://lux.wpkt.cash';\nlet connected = false;\nlet installed = false;\nlet accounts = null;\nlet connectedStr = \"Wallet Connect\";\nlet currentAccount = null;\n\nasync function isMetaMaskConnected() {\n  const {\n    ethereum\n  } = window;\n  accounts = await ethereum.request({\n    method: 'eth_accounts'\n  });\n  console.log('In Metamask connection:', accounts && accounts.length > 0);\n  return Boolean(accounts && accounts.length > 0);\n}\n\nfunction isMetaMaskInstalled() {\n  console.log('In isMetaMaskInstalled');\n  return Boolean(window.ethereum && window.ethereum.isMetaMask);\n}\n\nasync function initialise() {\n  connected = false;\n  installed = false;\n  connected = await isMetaMaskConnected();\n  installed = isMetaMaskInstalled();\n} //initialise();\n\n\nif (typeof window.ethereum !== 'undefined') {\n  window.ethereum.on('accountsChanged', async () => {\n    await initialise();\n    console.log('accounts changed here');\n\n    if (connectedStr !== 'Wallet Connect') {\n      window.location.reload();\n    }\n  });\n}\n\nconst onClickConnect = async () => {\n  const {\n    ethereum\n  } = window;\n\n  try {\n    // Will open the MetaMask UI\n    console.log(\"Try to connect here\");\n    currentAccount = await ethereum.request({\n      method: 'eth_requestAccounts'\n    });\n    await initialise();\n    console.log('current account:', currentAccount, accounts[0]);\n  } catch (error) {\n    console.error(error);\n  }\n};\n\nfunction WalletButton() {\n  const onboarding = new MetaMaskOnboarding({\n    forwarderOrigin\n  });\n  const [label, setLabel] = useState(\"Connect Wallet\");\n\n  try {\n    initialise();\n    console.log('accounts', accounts);\n    connectedStr = accounts && accounts.length > 0 ? accounts[0].toString().slice(0, 6) + '...' : \"Connect Wallet\";\n  } catch (error) {\n    console.log(error);\n  }\n\n  return /*#__PURE__*/React.createElement(StyledButton, {\n    id: \"connectButton\",\n    primary: true,\n    size: \"large\",\n    pad: \"medium\",\n    color: \"#F0B90C\",\n    label: label,\n    onClick: async () => {\n      await onClickConnect();\n      connectedStr = accounts && accounts.length > 0 ? accounts[0].toString().slice(0, 6) + '...' : \"Connect Wallet\";\n      console.log('currentAccount:', currentAccount, 'connectedStr:', connectedStr, 'connected:', connected, 'accounts:', accounts && accounts.length > 0);\n      setLabel(connectedStr);\n\n      if (typeof window.ethereum === 'undefined') {\n        onboarding.startOnboarding();\n        return;\n      }\n    },\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 97,\n      columnNumber: 5\n    }\n  });\n}\n\nfunction App() {\n  const {\n    loading,\n    error,\n    data\n  } = useQuery(GET_TRANSFERS);\n  const items = [{\n    label: 'Teleport',\n    href: '/'\n  }];\n  React.useEffect(() => {\n    if (!loading && !error && data && data.transfers) {\n      console.log({\n        transfers: data.transfers\n      });\n    }\n  }, [loading, error, data]); //connectMetamask();\n  //initialise();\n\n  return /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 133,\n      columnNumber: 5\n    }\n  }, /*#__PURE__*/React.createElement(Collapsible, {\n    btn: WalletButton(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 134,\n      columnNumber: 5\n    }\n  }), /*#__PURE__*/React.createElement(Router, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 135,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(Switch, {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 136,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(Route, {\n    exact: true,\n    path: \"/\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 137,\n      columnNumber: 13\n    }\n  }, /*#__PURE__*/React.createElement(Teleport, {\n    btn: WalletButton(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 138,\n      columnNumber: 15\n    }\n  })))));\n}\n\nexport default App;","map":{"version":3,"names":["React","useState","useQuery","ethers","detectEthereumProvider","MetaMaskOnboarding","Button","Footer","Text","Box","Grommet","ResponsiveContext","BrowserRouter","Router","Route","Switch","Teleport","Collapsible","Cookies","GET_TRANSFERS","StyledButton","ButtonForm","ButtonFooter","ImageFooter","customBreakpoints","WalletConnectProvider","Connect","clr","cookies","web3Provider","provider","forwarderOrigin","connected","installed","accounts","connectedStr","currentAccount","isMetaMaskConnected","ethereum","window","request","method","console","log","length","Boolean","isMetaMaskInstalled","isMetaMask","initialise","on","location","reload","onClickConnect","error","WalletButton","onboarding","label","setLabel","toString","slice","startOnboarding","App","loading","data","items","href","useEffect","transfers"],"sources":["/Library/WebServer/Documents/MachineLearning/trading/PKT-CASH/LUX/LUXDApp/LUXBridgeDApp/packages/react-app/src/App.js"],"sourcesContent":["import React, { useState } from \"react\";\nimport { useQuery } from \"@apollo/react-hooks\";\nimport { ethers } from \"ethers\";\nimport detectEthereumProvider from '@metamask/detect-provider'\nimport MetaMaskOnboarding from '@metamask/onboarding'\nimport { Button, Footer, Text, Box, Grommet, ResponsiveContext } from \"grommet\";\nimport { BrowserRouter as Router, Route, Switch } from \"react-router-dom\";\nimport Teleport from \"./components/Teleport\";\nimport Collapsible from \"./components/Collapsible\";\n//import useWeb3Modal from \"./hooks/useWeb3Modal\";\nimport Cookies from 'universal-cookie';\nimport GET_TRANSFERS from \"./graphql/subgraph\";\nimport logoFooter from \"./img/odapp-logo-footer.svg\";\nimport { StyledButton, ButtonForm, ButtonFooter, ImageFooter, customBreakpoints } from \"./components/\";\nimport WalletConnectProvider from \"@walletconnect/web3-provider\";\nimport {\n  Connect\n} from 'grommet-icons';\n\nvar clr = '#FBA300';\n\nconst cookies = new Cookies();\n\nvar web3Provider, provider;\nconst forwarderOrigin = 'http://lux.wpkt.cash';\n\nlet connected = false;\nlet installed = false;\nlet accounts = null;\nlet connectedStr = \"Wallet Connect\";\nlet currentAccount = null;\n\nasync function isMetaMaskConnected() {\n    const {ethereum} = window;\n    accounts = await ethereum.request({method: 'eth_accounts'});\n    console.log('In Metamask connection:', (accounts && accounts.length > 0));\n    return Boolean(accounts && accounts.length > 0);\n}\n\nfunction isMetaMaskInstalled() {\n    console.log('In isMetaMaskInstalled');\n    return Boolean(window.ethereum && window.ethereum.isMetaMask);\n}\n\n\nasync function initialise() {\n    connected = false;\n    installed = false;\n    connected = await isMetaMaskConnected();\n    installed = isMetaMaskInstalled();\n}\n\n//initialise();\n\nif (typeof window.ethereum !== 'undefined') {\n  window.ethereum.on('accountsChanged', async () => {\n      await initialise();\n      console.log('accounts changed here');\n      if (connectedStr !== 'Wallet Connect'){\n        window.location.reload();\n      }\n\n  });\n}\n\n\nconst onClickConnect = async () => {\n  const { ethereum } = window;\n   try {\n     // Will open the MetaMask UI\n     console.log(\"Try to connect here\");\n     currentAccount = await ethereum.request({ method: 'eth_requestAccounts' });\n     await initialise();\n     console.log('current account:', currentAccount, accounts[0]);\n   } catch (error) {\n     console.error(error);\n   }\n };\n\nfunction WalletButton() {\n  const onboarding = new MetaMaskOnboarding({ forwarderOrigin });\n  const [label, setLabel] = useState(\"Connect Wallet\");\n\n  try {\n    initialise();\n    console.log('accounts', accounts);\n    connectedStr = (accounts && accounts.length > 0) ? ((accounts[0].toString()).slice(0,6))+'...' :  \"Connect Wallet\";\n\n  }\n  catch(error){\n    console.log(error);\n  }\n\n\n\n  return (\n    <StyledButton id=\"connectButton\" primary size='large' pad=\"medium\" color='#F0B90C' label={label} onClick={async () => {\n      await onClickConnect();\n      connectedStr = (accounts && accounts.length > 0) ? ((accounts[0].toString()).slice(0,6))+'...' :  \"Connect Wallet\";\n      console.log('currentAccount:',currentAccount, 'connectedStr:', connectedStr, 'connected:', connected, 'accounts:', (accounts && accounts.length > 0));\n      setLabel(connectedStr);\n\n      if (typeof window.ethereum === 'undefined') {\n        onboarding.startOnboarding();\n        return;\n      }\n    }}/>\n\n  );\n}\n\n\n\nfunction App() {\n\n  const { loading, error, data } = useQuery(GET_TRANSFERS);\n\n  const items = [\n    { label: 'Teleport', href: '/' },\n  ];\n\n  React.useEffect(() => {\n    if (!loading && !error && data && data.transfers) {\n      console.log({ transfers: data.transfers });\n    }\n  }, [loading, error, data]);\n\n  //connectMetamask();\n  //initialise();\n\n\n  return (\n    <div>\n    <Collapsible btn={ WalletButton() }/>\n        <Router>\n          <Switch>\n            <Route exact path=\"/\">\n              <Teleport btn={ WalletButton() }/>\n            </Route>\n\n          </Switch>\n        </Router>\n\n    </div>\n  );\n}\n\nexport default App;\n"],"mappings":"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"},"metadata":{},"sourceType":"module"}